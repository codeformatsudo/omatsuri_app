!function(){var t=L.extend({},L.Map.prototype),o=L.extend({},L.Control.prototype);L.Map.include({_controlledBounds:null,getControlledBounds:function(){return this._controlledBounds||this._calculateControlledBounds(),this._controlledBounds},_calculateControlledBounds:function(){for(var t=this.getSize(),o={topleft:[L.point(0,0)],topright:[L.point(t.x,0)],bottomleft:[L.point(0,t.y)],bottomright:[L.point(t.x,t.y)]},e=0,a=0;a<this._controlCorners.topleft.children.length;a++){var r=this._controlCorners.topleft.children[a];if(r.offsetTop+r.offsetLeft+r.offsetWidth+r.offsetHeight>0){for(var i=r.offsetTop,n=r.offsetLeft,s=i+r.offsetHeight,p=n+r.offsetWidth,m=0;m<o.topleft.length;m++)o.topleft[m]&&o.topleft[m].x<p&&(o.topleft[m]=null);o.topleft.push(L.point(p,e)),o.topleft.push(L.point(0,s)),e=s}}e=0;for(var a=0;a<this._controlCorners.topright.children.length;a++){var r=this._controlCorners.topright.children[a];if(r.offsetTop+r.offsetLeft+r.offsetWidth+r.offsetHeight>0){for(var i=r.offsetTop,n=r.offsetLeft+this._controlCorners.topright.offsetLeft,s=i+r.offsetHeight,p=n+r.offsetWidth,m=0;m<o.topright.length;m++)o.topright[m]&&o.topright[m].x>n&&(o.topright[m]=null);o.topright.push(L.point(n,e)),o.topright.push(L.point(t.x,s)),e=s}}for(var d=t.y,a=this._controlCorners.bottomleft.children.length-1;a>=0;a--){var r=this._controlCorners.bottomleft.children[a];if(r.offsetTop+r.offsetLeft+r.offsetWidth+r.offsetHeight>0){for(var i=r.offsetTop+this._controlCorners.bottomleft.offsetTop,n=r.offsetLeft,s=i+r.offsetHeight,p=n+r.offsetWidth,m=0;m<o.bottomleft.length;m++)o.bottomleft[m]&&o.bottomleft[m].x<p&&(o.bottomleft[m]=null);o.bottomleft.push(L.point(p,d)),o.bottomleft.push(L.point(0,i)),d=i}}d=t.y;for(var a=this._controlCorners.bottomright.children.length-1;a>=0;a--){var r=this._controlCorners.bottomright.children[a];if(r.offsetTop+r.offsetLeft+r.offsetWidth+r.offsetHeight>0){for(var i=r.offsetTop+this._controlCorners.bottomright.offsetTop,n=r.offsetLeft+this._controlCorners.bottomright.offsetLeft,s=i+r.offsetHeight,p=n+r.offsetWidth,m=0;m<o.bottomright.length;m++)o.bottomright[m]&&o.bottomright[m].x>n&&(o.bottomright[m]=null);o.bottomright.push(L.point(n,d)),o.bottomright.push(L.point(t.x,i)),d=i}}o.topleft=o.topleft.filter(function(t){return!!t}),o.topright=o.topright.filter(function(t){return!!t}),o.bottomleft=o.bottomleft.filter(function(t){return!!t}),o.bottomright=o.bottomright.filter(function(t){return!!t});var h=-1/0,f=null;for(a=0;a<o.topleft.length;a++){var u=o.topleft[a];for(m=0;m<o.topright.length;m++){var c=o.topright[m];for(k=0;k<o.bottomleft.length;k++){var b=o.bottomleft[k];for(l=0;l<o.bottomright.length;l++){var g=o.bottomright[l],y=Math.max(u.y,c.y),v=Math.min(b.y,g.y),S=Math.max(u.x,b.x),x=Math.min(c.x,g.x),_=(v-y)*(x-S);_>h&&(h=_,f=L.bounds([[S,y],[x,v]]))}}}}var M,T;T=L.bounds([0,0],this.getSize()).getCenter(),M=this._lastControlledBounds?this._lastControlledBounds.getCenter():T;var C=f.getCenter();return this._controlledOffset=L.point([T.x-C.x,T.y-C.y]),this._lastControlledBounds=f,this._controlledBounds=f},getOffset:function(){return this._controlledOffset?this._controlledOffset:L.point(0,0)},_offsetLatLng:function(t,o){return o=void 0===o?this.getZoom():o,this.unproject(this.project(t,o).add(this.getOffset()),o)},_deoffsetLatLng:function(t,o){return o=void 0===o?this.getZoom():o,this.unproject(this.project(t,o).subtract(this.getOffset()),o)},setView:function(o,e){return t.setView.call(this,this._offsetLatLng(o,e),e)},setZoomAround:function(t,o,e){var a=this.getZoomScale(o),r=this.getSize().divideBy(2).subtract(this.getOffset()),i=t instanceof L.Point?t:this.latLngToContainerPoint(t),n=i.subtract(r).multiplyBy(1-1/a),s=this.containerPointToLatLng(r.add(n));return this.setView(s,o,{zoom:e})},setZoom:function(t,o){return this._loaded?this.setView(this._deoffsetLatLng(this.getCenter()),t,{zoom:o}):(this._zoom=t,this)},getBoundsZoom:function(t,o,e){t=L.latLngBounds(t);var m,a=this.getMinZoom()-(o?1:0),r=this.getMaxZoom(),i=this._controlledBounds,n=i?L.point(i.max.x-i.min.x,i.max.y-i.min.y):this.getSize(),s=t.getNorthWest(),p=t.getSouthEast(),l=!0;e=L.point(e||[0,0]);do a++,m=this.project(p,a).subtract(this.project(s,a)).add(e).floor(),l=o?m.x<n.x||m.y<n.y:n.contains(m);while(l&&r>=a);return l&&o?null:o?a:a-1},invalidateSize:function(){if(!this._loaded)return this;var o=this.getOffset();t.invalidateSize.call(this),this._calculateControlledBounds(),this.panBy(this.getOffset().subtract(o))}}),L.Control.include({addTo:function(t){return o.addTo.call(this,t),t.invalidateSize({animate:!0}),this},removeFrom:function(t){if(this._map){var e=this._map;return o.removeFrom.call(this,t),e.invalidateSize({animate:!0}),this}return o.removeFrom.call(this,t)}})}();