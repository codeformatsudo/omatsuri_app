L.Control.StyledLayerControl=L.Control.Layers.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0},initialize:function(t,e,a){var o,r;L.Util.setOptions(this,a),this._layers={},this._lastZIndex=0,this._handlingClick=!1,this._groupList=[],this._domGroups=[];for(o in t)for(var r in t[o].layers)this._addLayer(t[o].layers[r],r,t[o],!1);for(o in e)for(var r in e[o].layers)this._addLayer(e[o].layers[r],r,e[o],!0)},onAdd:function(t){return this._initLayout(),this._update(),t.on("layeradd",this._onLayerChange,this).on("layerremove",this._onLayerChange,this),this._container},onRemove:function(t){t.off("layeradd",this._onLayerChange).off("layerremove",this._onLayerChange)},addBaseLayer:function(t,e,a){return this._addLayer(t,e,a,!1),this._update(),this},addOverlay:function(t,e,a){return this._addLayer(t,e,a,!0),this._update(),this},removeLayer:function(t){var e=L.Util.stamp(t);return delete this._layers[e],this._update(),this},removeGroup:function(t){for(group in this._groupList)if(this._groupList[group].groupName==t){for(layer in this._layers)this._layers[layer].group&&this._layers[layer].group.name==t&&delete this._layers[layer];delete this._groupList[group],this._update();break}},_initLayout:function(){var t="leaflet-control-layers",e=this._container=L.DomUtil.create("div",t);e.setAttribute("aria-haspopup",!0),L.DomEvent.disableClickPropagation(e),L.DomEvent.on(e,"wheel",L.DomEvent.stopPropagation);var a=document.createElement("section");a.className="ac-container "+t+"-list";var o=this._form=L.DomUtil.create("form");if(a.appendChild(o),this.options.collapsed){L.Browser.android||L.DomEvent.on(e,"mouseover",this._expand,this).on(e,"mouseout",this._collapse,this);var r=this._layersLink=L.DomUtil.create("a",t+"-toggle",e);r.href="#",r.title="Layers",L.Browser.touch?L.DomEvent.on(r,"click",L.DomEvent.stop).on(r,"click",this._expand,this):L.DomEvent.on(r,"focus",this._expand,this),this._map.on("click",this._collapse,this)}else this._expand();this._baseLayersList=L.DomUtil.create("div",t+"-base",o),this._overlaysList=L.DomUtil.create("div",t+"-overlays",o),e.appendChild(a);for(var i=0;i<(containers=e.getElementsByClassName("ac-container")).length;i++)this.options.container_width&&(containers[i].style.width=this.options.container_width),this._default_maxHeight=this.options.container_maxHeight?this.options.container_maxHeight:this._map._size.y-70,containers[i].style.maxHeight=this._default_maxHeight+"px";window.onresize=this._on_resize_window.bind(this)},_on_resize_window:function(){for(var t=0;t<containers.length;t++)containers[t].style.maxHeight=window.innerHeight-90<this._removePxToInt(this._default_maxHeight)?window.innerHeight-90+"px":this._removePxToInt(this._default_maxHeight)+"px"},_removePxToInt:function(t){return parseInt(t.replace("px",""))},_addLayer:function(t,e,a,o){var r=L.Util.stamp(t);if(this._layers[r]={layer:t,name:e,overlay:o},a){var i=this._groupList.indexOf(a);if(-1===i)for(g in this._groupList)if(this._groupList[g].groupName==a.groupName){i=g;break}-1===i&&(i=this._groupList.push(a)-1),this._layers[r].group={name:a.groupName,id:i,expanded:a.expanded}}this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex))},_update:function(){if(this._container){this._baseLayersList.innerHTML="",this._overlaysList.innerHTML="",this._domGroups.length=0;var a,o,t=!1,e=!1;for(a in this._layers)o=this._layers[a],this._addItem(o),e=e||o.overlay,t=t||!o.overlay}},_onLayerChange:function(t){var e=this._layers[L.Util.stamp(t.layer)];if(e){this._handlingClick||this._update();var a=e.overlay?"layeradd"===t.type?"overlayadd":"overlayremove":"layeradd"===t.type?"baselayerchange":null;a&&this._map.fire(a,e)}},_createRadioElement:function(t,e){var a='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"';e&&(a+=' checked="checked"'),a+="/>";var o=document.createElement("div");return o.innerHTML=a,o.firstChild},_addItem:function(t){var a,r,e=document.createElement("div"),o=this._map.hasLayer(t.layer);t.overlay?(a=document.createElement("input"),a.type="checkbox",a.className="leaflet-control-layers-selector",a.defaultChecked=o,e.className="menu-item-checkbox"):(a=this._createRadioElement("leaflet-base-layers",o),e.className="menu-item-radio"),a.layerId=L.Util.stamp(t.layer),L.DomEvent.on(a,"click",this._onInputClick,this);var i=document.createElement("span");if(i.innerHTML=" "+t.name,e.appendChild(a),e.appendChild(i),t.layer.StyledLayerControl&&t.layer.StyledLayerControl.removable){var n=document.createElement("input");n.type="button",n.className="bt_delete",L.DomEvent.on(n,"click",this._onDeleteClick,this),e.appendChild(n)}r=t.overlay?this._overlaysList:this._baseLayersList;var s=this._domGroups[t.group.id];if(s)s.lastElementChild.appendChild(e);else{s=document.createElement("div"),s.id="leaflet-control-accordion-layers-"+t.group.id;var l=t.group.expanded?' checked = "true" ':"",p=this.options.exclusive?' type="radio" ':' type="checkbox" ';inputElement='<input id="ac'+t.group.id+'" name="accordion-1" class="menu" '+l+p+"/>",inputLabel='<label for="ac'+t.group.id+'">'+t.group.name+"</label>",article=document.createElement("article"),article.className="ac-large",article.appendChild(e),this.options.group_maxHeight&&(article.style.maxHeight=this.options.group_maxHeight),s.innerHTML=inputElement+inputLabel,s.appendChild(article),r.appendChild(s),this._domGroups[t.group.id]=s}return e},_onInputClick:function(){var t,e,a,o=this._form.getElementsByTagName("input"),r=o.length;for(this._handlingClick=!0,t=0;r>t;t++)if(e=o[t],a=this._layers[e.layerId])if(e.checked&&!this._map.hasLayer(a.layer)){this._map.addLayer(a.layer);{a.layer}}else!e.checked&&this._map.hasLayer(a.layer)&&this._map.removeLayer(a.layer);this._handlingClick=!1},_onDeleteClick:function(t){var e=t.target.parentElement.childNodes[0];return n_obj=this._layers[e.layerId],!n_obj.overlay&&e.checked?!1:(this._map.hasLayer(n_obj.layer)&&this._map.removeLayer(n_obj.layer),this.removeLayer(n_obj.layer),t.target.parentNode.remove(),!1)},_expand:function(){L.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-layers-expanded","")}}),L.Control.styledLayerControl=function(t,e,a){return new L.Control.StyledLayerControl(t,e,a)};